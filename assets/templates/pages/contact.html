{% extends "base.html" %}
{% load static %}

{% block title %}Contact - SecureBank{% endblock %}

{% block content %}

<section class="contact-section">
    <div class="container">
        <h2>Contact Us</h2>
        <p id="responseMsg" style="margin-top:10px;"></p>

        <div class="contact-box">
            <label>Name</label>
            <input type="text" id="name" placeholder="Enter your name">

            <label>Email</label>
            <input type="email" id="email" placeholder="Enter your email">

            <label>Message</label>
            <textarea id="message" rows="4" placeholder="Your message..."></textarea>

            <button onclick="submitContact()" class="btn-contact">Send Message</button>

            
        </div>
    </div>
</section>

<script>
function submitContact() {
    const data = {
        name: document.getElementById("name").value,
        email: document.getElementById("email").value,
        message: document.getElementById("message").value,
    };

    fetch("{% url 'contact_submit' %}", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "X-CSRFToken": getCookie("csrftoken")
        },
        body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(data => {
        const msg = document.getElementById("responseMsg");
        msg.innerHTML = data.message;
        msg.style.color = data.status === "success" ? "green" : "red";
    });
}


// CSRF helper
function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== "") {
        const cookies = document.cookie.split(";");
        for (let i of cookies) {
            const cookie = i.trim();
            if (cookie.startsWith(name + "=")) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

</script>

{% endblock %}
